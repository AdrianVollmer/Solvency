{% import "macros/ui.html" as ui %}
<div class="border-t border-neutral-200 dark:border-neutral-700 mt-4 pt-4">
<div class="flex items-center justify-between mb-4">
    <h3 class="text-sm font-semibold text-neutral-900 dark:text-white">
        {{ month_label }} &mdash; {{ count }} transaction{% if count != 1 %}s{% endif %}
    </h3>
    <button type="button" id="monthly-transactions-close"
        class="p-1.5 text-neutral-400 hover:text-neutral-600 dark:hover:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-700 rounded-lg transition-colors"
        aria-label="Close transaction list">
        <span class="icon-sm" aria-hidden="true">{{ icons.get("x")|safe }}</span>
    </button>
</div>
{% if transactions.is_empty() %}
<p class="text-sm text-neutral-500 dark:text-neutral-400">No transactions for this month.</p>
{% else %}
<div class="overflow-x-auto">
    <table class="w-full text-left">
        <thead>
            <tr class="border-b border-neutral-200 dark:border-neutral-700">
                <th class="px-3 py-2 text-xs font-medium text-neutral-500 dark:text-neutral-400">Date</th>
                <th class="px-3 py-2 text-xs font-medium text-neutral-500 dark:text-neutral-400">Description</th>
                <th class="px-3 py-2 text-xs font-medium text-neutral-500 dark:text-neutral-400">Category</th>
                <th class="px-3 py-2 text-xs font-medium text-neutral-500 dark:text-neutral-400 text-right">Amount</th>
            </tr>
        </thead>
        <tbody class="divide-y divide-neutral-100 dark:divide-neutral-700/50">
            {% for t in transactions %}
            <tr onclick="window.location.href='/transactions/{{ t.id }}'"
                class="hover:bg-neutral-50 dark:hover:bg-neutral-700/50 cursor-pointer">
                <td class="px-3 py-2 whitespace-nowrap text-sm tabular-nums text-neutral-600 dark:text-neutral-400">{{ t.date }}</td>
                <td class="px-3 py-2 text-sm">
                    <div class="font-medium text-neutral-900 dark:text-white">{{ t.description }}</div>
                    {% match t.counterparty() %}
                    {% when Some with (cp) %}
                    <div class="text-xs text-neutral-500 dark:text-neutral-400 truncate max-w-xs">{{ cp }}</div>
                    {% when None %}{% endmatch %}
                </td>
                <td class="px-3 py-2 whitespace-nowrap">
                    {% if t.has_category() %}
                    {% call ui::category_badge(color=t.category_color_or_default(), name=t.category_name_or_default()) %}{% endcall %}
                    {% else %}
                    <span class="text-neutral-400 text-xs">Uncategorized</span>
                    {% endif %}
                </td>
                <td class="px-3 py-2 whitespace-nowrap text-sm font-semibold text-right tabular-nums">
                    {{ settings.format_money(t.amount_cents)|safe }}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}
</div>
